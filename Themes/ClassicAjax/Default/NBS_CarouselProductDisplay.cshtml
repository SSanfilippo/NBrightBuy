@inherits NBrightBuy.render.NBrightBuyRazorTokens<NBrightRazor>
@using System.Linq
@using System.Web
@using NBrightDNN
@using Nevoweb.DNN.NBrightBuy.Components;

@AddMetaData("resourcepath", "/DesktopModules/NBright/NBrightBuy/App_LocalResources/")

@AddPreProcessMetaData("itemlistname", Model.GetSetting("itemlistname"), Model.FullTemplateName, Model.ModuleId.ToString())

@AddPreProcessMetaData("orderby", "{bycategoryproduct}", Model.FullTemplateName, Model.ModuleId.ToString()) <!-- set default to manual sort on category product -->
@AddPreProcessMetaData("orderby0", "{bycategoryproduct}", Model.FullTemplateName, Model.ModuleId.ToString())
@AddPreProcessMetaData("orderby1", "NB3.FromPrice", Model.FullTemplateName, Model.ModuleId.ToString())
@AddPreProcessMetaData("orderby2", "NB3.FromPrice DESC", Model.FullTemplateName, Model.ModuleId.ToString())
@AddPreProcessMetaData("orderby3", "NB3.ProductRef", Model.FullTemplateName, Model.ModuleId.ToString())
@AddPreProcessMetaData("orderby4", "NB3.ProductName", Model.FullTemplateName, Model.ModuleId.ToString())

<div class="nbs">

    <div class="destockage">

    <div class="destockage-header">
      <div class="carousel-cycle-nav">
        <span id="carouselprev"><i class="fa fa-angle-left"></i></span><span id="carouselnext"><i class="fa fa-angle-right"></i></span>
      </div>
      <div class="h2-headline">DÃ©stockage</div>
    </div>

    <div class="cycle-slideshow" data-cycle-fx="carousel" data-cycle-carousel-visible="4" data-cycle-carousel-vertical="true" data-cycle-fx="scrollHorz" data-cycle-slides=".carouselproduct" data-cycle-timeout="0" data-cycle-pause-on-hover="true" data-cycle-prev="#carouselprev" data-cycle-next="#carouselnext">

        @{
            var lang = "";
        }

        @foreach (NBrightInfo info in Model.List)
            {
                var product = new ProductData(info.ItemID, info.Lang);
                lang = info.Lang;

            <div class="carouselproduct">

                <div class="productimg">
                  @if (product.Imgs.Count > 0)
                  {
                      <div class="image">
                          <img title="@(info.GetXmlProperty("genxml/lang/genxml/textbox/txtsummary"))" src="@ProductImage(info, "80", "0")">
                      </div>
                  }
                  else
                  {
                      <div class="noimage">
                          @(Model.GetSettingHtmlOf("noimageicon"))
                      </div>
                  }
                </div>

                <div class="description">

                    <a href="@EntryUrl(info,Model)"><span>@info.GetXmlProperty("genxml/textbox/manufacturer")</span>@ProductName(info)</a>

                    <div class="price">
                        @if (product.IsOnSale)
                        {
                            <span class="old">@(NBrightBuyUtils.FormatToStoreCurrency(product.FromPrice()))</span>
                            <span class="sale">@(NBrightBuyUtils.FormatToStoreCurrency(product.BestPrice()))</span>
                        }
                        else
                        {
                            @(NBrightBuyUtils.FormatToStoreCurrency(product.BestPrice()))<span class="ttc">TTC</span>
                        }
                    </div>

                </div>

                <!-- fields required to send required ajax data to server -->
                <span class="entryid@(info.ItemID)">
                    <input id="@(info.ItemID)_productid" type="hidden" value="@(info.ItemID)">
                </span>

            </div>
        }

    </div>

    </div>

</div>
